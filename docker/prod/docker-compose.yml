version: '3'
services:
  # phishtray_db:
  #   logging:
  #     driver: awslogs
  #     options:
  #       awslogs-group: newEC2_LG
  #       awslogs-region: eu-west-2
  #       awslogs-stream-prefix: db
  #   image: $aws_account_id.dkr.ecr.$aws_default_region.amazonaws.com/phishtray/db:latest
  #   volumes:
  #   - /var/lib/mysql
  #   ports:
  #   - "3306:3306"
  #   environment:
  #   - MYSQL_ROOT_PASSWORD=admin
  #   - MYSQL_DATABASE=phishtray
  #   networks:
  #   - webnet

  phishtray_apps:
    logging:
      driver: awslogs
      options:
        awslogs-group: newEC2_LG
        awslogs-region: eu-west-2
        awslogs-stream-prefix: django
    image: $aws_account_id.dkr.ecr.$aws_default_region.amazonaws.com/phishtray/django:latest
    ports:
    - "9000:9000"
    environment:
    - DB_HOST=phishtray_db
    - DB_PORT=3306
    - DB_NAME=phishtray
    - DB_USER=user_1
    - DB_PASSWORD=user_password_1
    networks:
    - webnet
    # depends_on:
    # - phishtray_db


networks:
  webnet:
